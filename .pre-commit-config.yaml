# 🔧 Pre-commit Hooks Configuration for Research Automation System V1.0

repos:
  # 📝 Code formatting and linting
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
        exclude: ^data/|^results/|\.csv$
      - id: end-of-file-fixer
        exclude: ^data/|^results/
      - id: check-yaml
      - id: check-added-large-files
        args: ['--maxkb=5000']
      - id: check-merge-conflict
      - id: mixed-line-ending
        args: ['--fix=lf']

  # 🐍 Python code quality
  - repo: https://github.com/psf/black
    rev: 23.9.1
    hooks:
      - id: black
        language_version: python3
        args: ['--line-length=100', '--target-version=py38']

  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort
        args: ["--profile", "black", "--filter-files"]

  - repo: https://github.com/pycqa/flake8
    rev: 6.1.0
    hooks:
      - id: flake8
        args: ['--max-line-length=100', '--extend-ignore=E203,W503']

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.5.1
    hooks:
      - id: mypy
        additional_dependencies: [types-all]
        args: ['--ignore-missing-imports']

  # 📊 R code quality
  - repo: https://github.com/lorenzwalthert/precommit
    rev: v0.16.1
    hooks:
      - id: style-files
        args: ['--style_pkg=styler', '--style_fun=tidyverse_style']
      - id: lint-r
        args: ['--lintr_config=lintr_config']
      - id: deps-in-desc
        files: '^DESCRIPTION$'
      - id: use-tidy-description

  # 📝 Documentation
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v3.0.3
    hooks:
      - id: prettier
        types_or: [markdown, yaml, json, html, css]
        exclude: '^docs/_build/'

  # 🔍 Security scanning
  - repo: https://github.com/Lucas-C/pre-commit-hooks
    rev: v1.5.1
    hooks:
      - id: forbid-crlf
        exclude: ^data/.*\.csv$
      - id: remove-crlf
        exclude: '^data/'
      - id: forbid-tabs
        exclude: ^Makefile$

  # 🚀 Jupyter notebooks
  - repo: https://github.com/nbQA-dev/nbQA
    rev: 1.7.1
    hooks:
      - id: nbqa-black
        additional_dependencies: [black==23.9.1]
      - id: nbqa-isort
        additional_dependencies: [isort==5.12.0]
      - id: nbqa-flake8
        additional_dependencies: [flake8==6.1.0]
        args: ['--max-line-length=100', '--extend-ignore=E203,W503']

  # 📊 Automated testing
  - repo: https://github.com/pre-commit/mirrors-pytest
    rev: v7.4.0
    hooks:
      - id: pytest
        stages: [push]
        additional_dependencies: [pytest-cov, pytest-xdist]
        args: ['--cov=research_automation', '--cov-report=term-missing']

  # 🔨 Makefiles
  - repo: https://github.com/AleksaC/hadolint-pre-commit
    rev: v0.17.0
    hooks:
      - id: hadolint-docker
        files: Dockerfile$
        args: ['--ignore=DL3006', '--ignore=DL3018']

  # 📈 Data files validation
  - repo: https://github.com/pre-commit-hooks/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: check-json
        files: \.(json)$
      - id: check-toml
        files: \.(toml)$
      - id: check-xml
        files: \.(xml)$

  # 🔒 Secrets detection
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.4.0
    hooks:
      - id: detect-secrets
        args: ['--baseline', '.secrets.baseline']

# 🔧 Local hooks for research automation system
local:
  - repo: local
    hooks:
      # Publication quality check
      - id: publication-quality
        name: Publication Quality Check
        entry: python scripts/check_publication_quality.py
        language: system
        files: \.(py|R|md)$
        pass_filenames: false

      # Research documentation validation
      - id: validate-research-docs
        name: Research Documentation Validation
        entry: python scripts/validate_research_documents.py
        language: system
        files: \.(md)$
        pass_filenames: false

      # Data integrity check
      - id: data-integrity
        name: Data Integrity Check
        entry: python scripts/check_data_integrity.py
        language: system
        types: [python, r, yaml, json]
        pass_filenames: false
